<div id="uiBackground">
  <div class="previewBackground">
    <div id="previewBox">
      <h1 class="projectTitle" id="mockTitle">Project Title</h1>
      <p class="teamName" id="mockTeamName">Team Name<p>
    </div>
  </div>
  <div id="colors">
    <div>
      <form id="colorPicker" onchange="changeBGColor()">
        <label class="container">
          <input type="radio" name="color" value="#01A652">
          <span class="radioButton" id="green"></span>
        </label>

        <label class="container">
          <input type="radio" id="blue" name="color" value="#0C6FF9">
          <span class="radioButton" id="blue"></span>
        </label>

        <label class="container">
          <input type="radio"  name="color" value="#FF7E1D">
          <span class="radioButton" id="orange"></span>
        </label>

        <label class="container">
          <input type="radio"  name="color" value="#FEACD5">
          <span class="radioButton" id="pink"></span>
        </label>

        <label class="container">
          <input type="radio"  name="color" value="#A273C6">
          <span class="radioButton" id="purple"></span>
        </label>

        <label class="container">
          <input type="radio"  name="color" value="#EF3C3C">
          <span class="radioButton" id="red"></span>
        </label>

        <label class="container">
          <input type="radio"  name="color" value="#FFCE00">
          <span class="radioButton" id="yellow"></span>
        </label>
      
      </form>
    </div>
  </div>
  <div id="inputBox">
    <div>
      <input type="text" id="projectName" placeholder="Project Title" oninput="onTitleChange()">
    </div>
    <div>
      <input type="text" id="teamName" placeholder="Team Name" oninput="onTeamNameChange()">
    </div>

    <div>
      <input type="text" id="slackChannel" placeholder="#some-channel">
    </div>

    

    <div>
      <input type="text" id="productPOC" placeholder="PM Point of Contact">
    </div>

    <div>
      <input type="text" id="designPOC" placeholder="Design Point of Contact">
    </div>

    <div>
      <input type="text" id="engPOC" placeholder="Engineering Point of Contact">
    </div>

    <div>
      <textarea rows="5" id="projectDescription" placeholder="Short Project Description"></textarea>
    </div>

    <button id="createTemplate">Create Template</button>
  </div>
</div>

<style>

  #green {
    background-color: #49CE7F;
  }

  #blue {
    background-color: #0C6FF9;
  }

  #orange {
    background-color: #FF7E1D;
  }

  #pink {
    background-color: #FEACD5;
  }

  #purple {
    background-color: #A273C6;
  }

  #red {
    background-color: #EF3C3C;
  }

  #yellow {
    background-color: #FFCE00;
  }

  
  
  .container {
    margin: 16px;

  }


  .container input {
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;

  }

  .radioButton {
    position: absolute;
    height: 25px;
    width: 25px;
    background-color: rgba(1, 1, 1, .2);
    border-radius: 4px;
  }

  body {
    margin: 0;
  }
  #uiBackground {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .previewBackground {
    background-color: #FBFBFB;
    padding-top: 30px;
    padding-bottom: 30px;
  }

  #previewBox {
    width: 316px;
    height: 177px;
    background-color:#49CE7F;
    padding: 30px;
    margin: 0 auto;
  }

  .projectTitle {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    color: white;
  }

  .teamName {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    color: white;
  }

  input {
    background: #FFFFFF;
    border: 2px solid #FAF6F4;
    box-sizing: border-box;
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 12px;
    width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }
  
  input:focus {
    outline: none !important;
    border: 2px solid #0C6FF9;
  }

  textarea {
    background: #FFFFFF;
    border: 2px solid #FAF6F4;
    box-sizing: border-box;
    border-radius: 8px;
    padding: 8px;
    margin-bottom: 48px;
    width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    resize: none;
  }

  textarea:focus {
    outline: none !important;
    border: 2px solid #0C6FF9;
  }

  #inputBox {
    padding: 40px;
    
  }

  button {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 12px 32px;
    margin: 0 auto;
    border: none;

    /* Button Fill */

    background: #0C6FF9;
    /* HS Shadow */

    box-shadow: 0px 2px 0px rgba(26, 25, 25, 0.2);
    border-radius: 72px;
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    font-weight: 700;
  }

</style>


<script>

  var onTitleChange = () => {
    var currentTitleText = document.getElementById("projectName").value;
    var mockTitleText = document.getElementById("mockTitle");
    mockTitleText.innerHTML = currentTitleText;
  }

  var onTeamNameChange = () => {
    var currentTeamNameText = document.getElementById("teamName").value;
    var mockTeamNameText = document.getElementById("mockTeamName");
    mockTeamNameText.innerHTML = currentTeamNameText;
  }

  //set default
  let currentColor = "01A652"

  var changeBGColor = () => {
    var colorForm = document.getElementById("colorPicker")
    //find checked radio button
    for (var i = 0, length = colorForm.length; i < length; i++) {
      if (colorForm[i].checked) {
        // do whatever you want with the checked radio
        currentColor = colorForm[i].value;
        console.log(currentColor)
        document.getElementById("previewBox").style.backgroundColor = currentColor;
        // only one radio can be logically checked, don't check the rest
        break;
      }
}
  }

  document.getElementById('createTemplate').onclick = () => {
    projectName = document.getElementById("projectName").value
    teamName = document.getElementById("teamName").value

    projectDescription = document.getElementById("projectDescription").value
    productPOC = document.getElementById("productPOC").value
    designPOC = document.getElementById("designPOC").value
    engPOC = document.getElementById("engPOC").value
    

    slackChannel = document.getElementById("slackChannel").value
    hexColor = currentColor
    console.log(hexColor)

    function hexToRGB(h) {
      let r = 0, g = 0, b = 0;

      // 3 digits
      if (h.length == 4) {
        r = "0x" + h[1] + h[1];
        g = "0x" + h[2] + h[2];
        b = "0x" + h[3] + h[3];

      // 6 digits
      } else if (h.length == 7) {
        r = "0x" + h[1] + h[2];
        g = "0x" + h[3] + h[4];
        b = "0x" + h[5] + h[6];
      }
      

      rgbArray = [ (+r/255), (+g/255), (+b/255)]
      return rgbArray
    }

    rgbColorValues = hexToRGB(hexColor)


    parent.postMessage({ pluginMessage: { 
      type: 'createTemplate', 
      projectName: projectName, 
      projectDescription: projectDescription,
      productPOC: productPOC,
      designPOC: designPOC,
      engPOC: engPOC,
      teamName: teamName, 
      slackChannel: slackChannel, 
      color: rgbColorValues
    }}, '*')
  }

  

</script>


